# chrony.conf

# Serveurs de temps publics (utilisés quand Internet est disponible)
server 0.fr.pool.ntp.org iburst
server 1.fr.pool.ntp.org iburst
server 2.fr.pool.ntp.org iburst
server 3.fr.pool.ntp.org iburst

# Si les serveurs ci-dessus sont injoignables, utilise l'horloge locale
# comme référence et sers-la aux clients avec une strate de 10.
local stratum 10

# Fichier pour enregistrer la dérive de l'horloge système.
driftfile /var/lib/chrony/chrony.drift

# Autoriser un step au démarrage si l'écart est important
makestep 1.0 3

# Synchronisation RTC (inutile dans un conteneur sans RTC, sans effet si absente)
rtcsync

# Écoute sur toutes les interfaces du conteneur
bindaddress 0.0.0.0

# Autorisations : à restreindre à vos sous-réseaux !
# Exemples :
# allow 192.168.0.0/16
# allow 10.0.0.0/8
# Autoriser les clients du réseau du labo (à adapter)
# allow 192.168.1.0/24
# Autoriser les connexions depuis le réseau interne de Docker pour le healthcheck
# allow 172.16.0.0/12
allow 0.0.0.0/0

# Socket/port commande pour chronyc (pratique pour les checks)
cmdport 323

# Logs vers stdout/stderr (via -d). Activez si vous souhaitez des stats dans logs :
# log measurements statistics tracking
# logdir /var/log/chrony

# Écoute les commandes sur toutes les interfaces réseau (pas seulement localhost)
bindcmdaddress 0.0.0.0

# Autorise les commandes venant de n'importe où (nécessaire pour les autres conteneurs)
cmdallow 0.0.0.0/0

